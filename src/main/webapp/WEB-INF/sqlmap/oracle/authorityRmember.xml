<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="authorityRmember">
	<select id="list" resultType="Map" parameterType="Map">
	    select 
			MEMBER_SEQ	
			, ID_AUTHORITY
		from AUTHORITY_REL
 		<where>
 			<choose>
			    <when test="MEMBER_ID == null">
			        and 1=1
			    </when>
			    <otherwise>
			    	and MEMBER_SEQ = #{MEMBER_SEQ}
			    </otherwise>
		    </choose>
		</where>
	</select>

	<select id="read" resultType="Map" parameterType="Map">
	    select 
			MEMBER_SEQ	
			, ID_AUTHORITY
		from AUTHORITY_REL
		<where>
			and MEMBER_SEQ = #{MEMBER_SEQ}
		    <!-- choose>	using by CustomizeUserDetailsService.java
		        <when test="MEMBER_ID != null">
					and MEMBER_ID = #{MEMBER_ID}
		        </when>
		        <when test="MEMBER_SEQ != null">
					and MEMBER_SEQ = #{MEMBER_SEQ}
		        </when>
		    </choose-->
		</where>
	</select>

	<insert id="insert" parameterType="Map">
		INSERT INTO AUTHORITY_REL(
			MEMBER_SEQ	
			, ID_AUTHORITY
		)VALUES(
			#{MEMBER_SEQ}
			, #{ID_AUTHORITY}
		)
	</insert>

	<delete id="delete" parameterType="Map">
		delete from AUTHORITY_REL
		where MEMBER_SEQ = #{MEMBER_SEQ}
	</delete>
</mapper>